#include <connector/c/client.h>
#include <stdio.h>

int main() {

  struct tnt *conn = tnt_init();

  if ( tnt_connect(conn, "localhost", 33013) != TNT_EOK )

	  tnt_free(conn);
	  return 1;

  {
    const char message[]= {
	    0xd, 0x0, 0x0, 0x0,    0x11, 0x0, 0x0, 0x0,    0x0, 0x0, 0x0, 0x0,
	    0x0, 0x0, 0x0, 0x0,    0x0, 0x0, 0x0, 0x0,     0x1, 0x0, 0x0, 0x0,
	    0x4,    0x1, 0x0, 0x0, 0x0 };
    int res = tnt_execute_raw(conn, message, sizeof message);
    printf("return_code: %d\n", res); // =0
  }
  {
    /*
     * A test case for Bug#702397
     * https://bugs.launchpad.net/tarantool/+bug/702397
     * "If SELECT request specifies tuple count 0, no error"
     */
    const char message[]= {
	    0x11, 0x0, 0x0, 0x0,    0x14, 0x0, 0x0, 0x0,    0x0, 0x0, 0x0, 0x0,
	    0x0, 0x0, 0x0, 0x0,     0x0, 0x0, 0x0, 0x0,     0x0, 0x0, 0x0, 0x0,
	    0xff, 0xff, 0xff, 0xff, 0x0, 0x0, 0x0, 0x0 };
    int res = tnt_execute_raw(conn, message, sizeof message);
    printf("return_code: %d\n", res); // =2
  }

  tnt_close(conn);
  return 0;
}
