# encoding: utf-8
#
import os
import shutil

iterator_lua_path = os.path.join(vardir, "utils.lua")
shutil.copy("big/utils.lua", iterator_lua_path)

admin("dofile('utils.lua')")
shutil.rmtree(iterator_lua_path, True)

admin("box.insert(20, 'pid_001', 'sid_001', 'tid_998', 'a')")
admin("box.insert(20, 'pid_002', 'sid_001', 'tid_997', 'a')")
admin("box.insert(20, 'pid_003', 'sid_002', 'tid_997', 'b')")
admin("box.insert(20, 'pid_005', 'sid_002', 'tid_996', 'b')")
admin("box.insert(20, 'pid_007', 'sid_003', 'tid_996', 'a')")
admin("box.insert(20, 'pid_011', 'sid_004', 'tid_996', 'c')")
admin("box.insert(20, 'pid_013', 'sid_005', 'tid_996', 'b')")
admin("box.insert(20, 'pid_017', 'sid_006', 'tid_996', 'a')")
admin("box.insert(20, 'pid_019', 'sid_005', 'tid_995', 'a')")
admin("box.insert(20, 'pid_023', 'sid_005', 'tid_994', 'a')")

print """
#-----------------------------------------------------------------------------#
# Iterator: tree single-part unique
#-----------------------------------------------------------------------------#
"""
admin("iterate(20, 0, 0, 1)")
admin("iterate(20, 0, 0, 1, box.index.ALL)")
admin("iterate(20, 0, 0, 1, box.index.EQ)")
admin("iterate(20, 0, 0, 1, box.index.REQ)")
admin("iterate(20, 0, 0, 1, box.index.GE)")
admin("iterate(20, 0, 0, 1, box.index.GT)")
admin("iterate(20, 0, 0, 1, box.index.LE)")
admin("iterate(20, 0, 0, 1, box.index.LT)")
admin("iterate(20, 0, 0, 1, box.index.EQ, 'pid_003')")
admin("iterate(20, 0, 0, 1, box.index.REQ, 'pid_003')")
admin("iterate(20, 0, 0, 1, box.index.EQ, 'pid_666')")
admin("iterate(20, 0, 0, 1, box.index.REQ, 'pid_666')")
admin("iterate(20, 0, 0, 1, box.index.GE, 'pid_001')")
admin("iterate(20, 0, 0, 1, box.index.GT, 'pid_001')")
admin("iterate(20, 0, 0, 1, box.index.GE, 'pid_999')")
admin("iterate(20, 0, 0, 1, box.index.GT, 'pid_999')")
admin("iterate(20, 0, 0, 1, box.index.LE, 'pid_002')")
admin("iterate(20, 0, 0, 1, box.index.LT, 'pid_002')")
admin("iterate(20, 0, 0, 1, box.index.LE, 'pid_000')")
admin("iterate(20, 0, 0, 1, box.index.LT, 'pid_000')")

print """
#-----------------------------------------------------------------------------#
# Iterator: tree single-part non-unique
#-----------------------------------------------------------------------------#
"""
admin("iterate(20, 1, 1, 2, box.index.ALL)")
admin("iterate(20, 1, 1, 2, box.index.EQ)")
admin("iterate(20, 1, 1, 2, box.index.REQ)")
admin("iterate(20, 1, 1, 2, box.index.GE)")
admin("iterate(20, 1, 1, 2, box.index.GT)")
admin("iterate(20, 1, 1, 2, box.index.LE)")
admin("iterate(20, 1, 1, 2, box.index.LT)")
admin("iterate(20, 1, 1, 2, box.index.EQ, 'sid_005')")
admin("iterate(20, 1, 1, 2, box.index.REQ, 'sid_005')")
admin("iterate(20, 1, 1, 2, box.index.GE, 'sid_005')")
admin("iterate(20, 1, 1, 2, box.index.GT, 'sid_005')")
admin("iterate(20, 1, 1, 2, box.index.GE, 'sid_999')")
admin("iterate(20, 1, 1, 2, box.index.GT, 'sid_999')")
admin("iterate(20, 1, 1, 2, box.index.LE, 'sid_005')")
admin("iterate(20, 1, 1, 2, box.index.LT, 'sid_005')")
admin("iterate(20, 1, 1, 2, box.index.LE, 'sid_000')")
admin("iterate(20, 1, 1, 2, box.index.LT, 'sid_000')")

print """
#-----------------------------------------------------------------------------#
# Iterator: tree multi-part unique
#-----------------------------------------------------------------------------#
"""
admin("iterate(20, 2, 1, 3, box.index.ALL)")
admin("iterate(20, 2, 1, 3, box.index.EQ)")
admin("iterate(20, 2, 1, 3, box.index.REQ)")
admin("iterate(20, 2, 1, 3, box.index.GE)")
admin("iterate(20, 2, 1, 3, box.index.GT)")
admin("iterate(20, 2, 1, 3, box.index.LE)")
admin("iterate(20, 2, 1, 3, box.index.LT)")
admin("iterate(20, 2, 1, 3, box.index.EQ, 'sid_005')")
admin("iterate(20, 2, 1, 3, box.index.EQ, 'sid_005', 'tid_995')")
admin("iterate(20, 2, 1, 3, box.index.EQ, 'sid_005', 'tid_999')")
admin("iterate(20, 2, 1, 3, box.index.REQ, 'sid_005')")
admin("iterate(20, 2, 1, 3, box.index.REQ, 'sid_005', 'tid_995')")
admin("iterate(20, 2, 1, 3, box.index.REQ, 'sid_005', 'tid_999')")
admin("iterate(20, 2, 1, 3, box.index.GE, 'sid_005')")
admin("iterate(20, 2, 1, 3, box.index.GT, 'sid_005')")
admin("iterate(20, 2, 1, 3, box.index.GE, 'sid_005', 'tid_995')")
admin("iterate(20, 2, 1, 3, box.index.GT, 'sid_005', 'tid_995')")
admin("iterate(20, 2, 1, 3, box.index.GE, 'sid_005', 'tid_999')")
admin("iterate(20, 2, 1, 3, box.index.GT, 'sid_005', 'tid_999')")
admin("iterate(20, 2, 1, 3, box.index.GE, 'sid_999')")
admin("iterate(20, 2, 1, 3, box.index.GT, 'sid_999')")
admin("iterate(20, 2, 1, 3, box.index.LE, 'sid_005')")
admin("iterate(20, 2, 1, 3, box.index.LT, 'sid_005')")
admin("iterate(20, 2, 1, 3, box.index.LE, 'sid_005', 'tid_997')")
admin("iterate(20, 2, 1, 3, box.index.LT, 'sid_005', 'tid_997')")
admin("iterate(20, 2, 1, 3, box.index.LE, 'sid_005', 'tid_000')")
admin("iterate(20, 2, 1, 3, box.index.LT, 'sid_005', 'tid_000')")
admin("iterate(20, 2, 1, 3, box.index.LE, 'sid_000')")
admin("iterate(20, 2, 1, 3, box.index.LT, 'sid_000')")

print """
#-----------------------------------------------------------------------------#
# Iterator: tree multi-part non-unique
#-----------------------------------------------------------------------------#
"""

admin("iterate(20, 3, 2, 4, box.index.ALL)")
admin("iterate(20, 3, 2, 4, box.index.EQ)")
admin("iterate(20, 3, 2, 4, box.index.REQ)")
admin("iterate(20, 3, 2, 4, box.index.GE)")
admin("iterate(20, 3, 2, 4, box.index.GT)")
admin("iterate(20, 3, 2, 4, box.index.LE)")
admin("iterate(20, 3, 2, 4, box.index.LT)")
admin("iterate(20, 3, 2, 4, box.index.EQ, 'tid_996')")
admin("iterate(20, 3, 2, 4, box.index.EQ, 'tid_996', 'a')")
admin("iterate(20, 3, 2, 4, box.index.EQ, 'tid_996', 'z')")
admin("iterate(20, 3, 2, 4, box.index.REQ, 'tid_996')")
admin("iterate(20, 3, 2, 4, box.index.REQ, 'tid_996', 'a')")
admin("iterate(20, 3, 2, 4, box.index.REQ, 'tid_996', '0')")
admin("iterate(20, 3, 2, 4, box.index.GE, 'tid_997')")
admin("iterate(20, 3, 2, 4, box.index.GT, 'tid_997')")
admin("iterate(20, 3, 2, 4, box.index.GE, 'tid_998')")
admin("iterate(20, 3, 2, 4, box.index.GT, 'tid_998')")
admin("iterate(20, 3, 2, 4, box.index.LE, 'tid_997')")
admin("iterate(20, 3, 2, 4, box.index.LT, 'tid_997')")
admin("iterate(20, 3, 2, 4, box.index.LE, 'tid_000')")
admin("iterate(20, 3, 2, 4, box.index.LT, 'tid_000')")
admin("iterate(20, 3, 2, 4, box.index.LT, 'tid_996', 'to', 'many', 'keys')")

print """
#-----------------------------------------------------------------------------#
# Iterator: hash single-part unique
#-----------------------------------------------------------------------------#
"""

admin("iterate(20, 4, 0, 1)")
admin("iterate(20, 4, 0, 1, box.index.ALL)")
admin("iterate(20, 4, 0, 1, box.index.EQ)")
admin("iterate(20, 4, 0, 1, box.index.GE)")
admin("iterate(20, 4, 0, 1, box.index.EQ, 'pid_003')")
admin("iterate(20, 4, 0, 1, box.index.EQ, 'pid_666')")
admin("iterate(20, 4, 0, 1, box.index.GE, 'pid_001')")
admin("iterate(20, 4, 0, 1, box.index.GE, 'pid_999')")

print """
#-----------------------------------------------------------------------------#
# Iterator: hash multi-part unique
#-----------------------------------------------------------------------------#
"""
admin("iterate(20, 5, 1, 3, box.index.ALL)")
admin("iterate(20, 5, 1, 3, box.index.EQ)")
admin("iterate(20, 5, 1, 3, box.index.EQ, 'sid_005')")
admin("iterate(20, 5, 1, 3, box.index.GE)")
admin("iterate(20, 2, 1, 3, box.index.EQ, 'sid_005', 'tid_995')")
admin("iterate(20, 2, 1, 3, box.index.EQ, 'sid_005', 'tid_999')")
admin("iterate(20, 2, 1, 3, box.index.EQ, 'sid_005', 'tid_995', 'a')")
admin("iterate(20, 2, 1, 3, box.index.GE, 'sid_005', 'tid_995')")
admin("iterate(20, 2, 1, 3, box.index.GE, 'sid_005', 'tid_999')")

print """
#-----------------------------------------------------------------------------#
# Iterator: various
#-----------------------------------------------------------------------------#
"""

admin("box.space[20].index[0]:iterator(-666)")

admin("box.space[20]:truncate()")
